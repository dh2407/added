openapi: 3.1.0
info:
  title: E-learning API
  description: API for E-learning app.
  version: 1.0.0
servers:
  - url: https://54321-dh2407-added-8ol4ts940g5.ws-eu115.gitpod.io/functions/v1
    description: Development server for internal use
  - url: https://api.example.com/v1
    description: Main production server
components:
  schemas:
    Action:
      type: object
      properties:
        id:
          type: string
          example: "9adfd1f0-28fb-4293-bfcb-6e8b3e6e504f"
        next_section_id:
          type: string
          example: "e28b8877-bcdf-4c6d-9b24-9fd183a916ff"
        label:
          type: string
          example: "Accept the Challenge"
      required:
        - id
        - next_section_id
        - label

    Page:
      type: object
      properties:
        id:
          type: string
          example: "12345"
        html:
          type: string
          example: "<p>This is an example page content.</p>"
        actions:
          type: array
          items:
            $ref: '#/components/schemas/Action'
          example:
            - id: "9adfd1f0-28fb-4293-bfcb-6e8b3e6e504f"
              next_section_id: "e28b8877-bcdf-4c6d-9b24-9fd183a916ff"
              label: "Accept the Challenge"
      required:
        - id
        - html

    Segment:
      type: object
      properties:
        text:
          type: string
          example: "Once upon a time..."
        sound_url:
          type: string
          example: "https://example.com/sound.mp3"
      required:
        - text

    Scene:
      type: object
      properties:
        image_url:
          type: string
          example: "https://example.com/image.jpg"
        segments:
          type: array
          items:
            $ref: '#/components/schemas/Segment'
      required:
        - image_url
        - segments

    SectionResponse:
      type: object
      properties:
        section_id:
          type: string
          example: "d6e3a8c3-466b-4f12-9b0e-8417fda41a9b"
        kind:
          type: string
          enum:
            - STORY
            - QUESTIONS_GAME
            - PAGE
          example: PAGE
        scenes:
          type: array
          items:
            $ref: '#/components/schemas/Scene'
          nullable: true
          example: null
        page:
          $ref: '#/components/schemas/Page'
        is_last:
          type: boolean
          example: false
      required:
        - section_id
        - kind
        - is_last
        - page
      examples:
        example1:
          summary: Example response with kind PAGE
          value:
            section_id: "67890"
            kind: PAGE
            scenes: null
            page:
              id: "12345"
              html: "<p>This is an example page content.</p>"
              actions:
                - id: "9adfd1f0-28fb-4293-bfcb-6e8b3e6e504f"
                  next_section_id: "e28b8877-bcdf-4c6d-9b24-9fd183a916ff"
                  label: "Accept the Challenge"
            is_last: false
        example2:
          summary: Example response with kind STORY
          value:
            section_id: "54321"
            kind: STORY
            scenes:
              - image_url: "https://example.com/story_image1.jpg"
                segments:
                  - text: "The story begins..."
                    sound_url: "https://example.com/story_sound1.mp3"
                  - text: "And continues..."
                    sound_url: "https://example.com/story_sound2.mp3"
              - image_url: "https://example.com/story_image2.jpg"
                segments:
                  - text: "The climax of the story."
                    sound_url: "https://example.com/story_sound3.mp3"
            page: null
            is_last: false
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

paths:
  /section-get_next_section:
    post:
      summary: Retrieve the next section based on the provided section ID.
      security:
        - BearerAuth: []
      requestBody:
        description: Section ID to fetch the next section.
        content:
          application/json:
            schema:
              type: object
              properties:
                section_id:
                  type: string
                  example: "d6e3a8c3-466b-4f12-9b0e-8417fda41a9b"
              required:
                - section_id
      responses:
        '200':
          description: Successfully retrieved the next section.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SectionResponse'
              examples:
                example1:
                  summary: Example response with kind PAGE
                  value:
                    section_id: "d6e3a8c3-466b-4f12-9b0e-8417fda41a9b"
                    kind: PAGE
                    scenes: null
                    page:
                      id: "12345"
                      html: "<p>This is an example page content.</p>"
                      actions:
                        - id: "9adfd1f0-28fb-4293-bfcb-6e8b3e6e504f"
                          next_section_id: "e28b8877-bcdf-4c6d-9b24-9fd183a916ff"
                          label: "Accept the Challenge"
                    is_last: false
                example2:
                  summary: Example response with kind STORY
                  value:
                    section_id: "d6e3a8c3-466b-4f12-9b0e-8417fda41a9b"
                    kind: STORY
                    scenes:
                      - image_url: "https://example.com/story_image1.jpg"
                        segments:
                          - text: "The story begins..."
                            sound_url: "https://example.com/story_sound1.mp3"
                          - text: "And continues..."
                            sound_url: "https://example.com/story_sound2.mp3"
                      - image_url: "https://example.com/story_image2.jpg"
                        segments:
                          - text: "The climax of the story."
                            sound_url: "https://example.com/story_sound3.mp3"
                    page: null
                    is_last: false
        '400':
          description: Bad request, invalid or missing section_id.
        '405':
          description: Method not allowed for this endpoint.
        '500':
          description: Internal server error.

  /section-get_first_section:
    post:
      summary: Retrieve the first section based on the provided subject ID.
      security:
        - BearerAuth: []
      requestBody:
        description: Subject ID to fetch the first section.
        content:
          application/json:
            schema:
              type: object
              properties:
                subject_id:
                  type: string
                  example: "a7c35f87-6b99-4cf4-9f7b-4fef2d7d85e1"
              required:
                - subject_id
      responses:
        '200':
          description: Successfully retrieved the first section.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SectionResponse'
              examples:
                example1:
                  summary: Example response with kind PAGE
                  value:
                    section_id: "d6e3a8c3-466b-4f12-9b0e-8417fda41a9b"
                    kind: PAGE
                    scenes: null
                    page:
                      id: "12345"
                      html: "<p>This is an example page content.</p>"
                      actions:
                        - id: "9adfd1f0-28fb-4293-bfcb-6e8b3e6e504f"
                          next_section_id: "e28b8877-bcdf-4c6d-9b24-9fd183a916ff"
                          label: "Accept the Challenge"
                    is_last: false
                example2:
                  summary: Example response with kind STORY
                  value:
                    section_id: "54321"
                    kind: STORY
                    scenes:
                      - image_url: "https://example.com/story_image1.jpg"
                        segments:
                          - text: "The story begins..."
                            sound_url: "https://example.com/story_sound1.mp3"
                          - text: "And continues..."
                            sound_url: "https://example.com/story_sound2.mp3"
                      - image_url: "https://example.com/story_image2.jpg"
                        segments:
                          - text: "The climax of the story."
                            sound_url: "https://example.com/story_sound3.mp3"
                    page: null
                    is_last: false
        '400':
          description: Bad request, invalid or missing subject_id.
        '405':
          description: Method not allowed for this endpoint.
        '500':
          description: Internal server error.
